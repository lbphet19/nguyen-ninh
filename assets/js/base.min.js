function sortAscending(a, b) {
    return $(a).attr("data-exp") > $(b).attr("data-exp")
}
function init() {
    if ($("div#ReCharge").length >= 1 && $("div#ReCharge").before('<section class="three-col alt subs"><div id="header-spacer"></div><article class="double"><hgroup class="standard"><h1>My Subscriptions</h1></hgroup></article></section>'),
    $("body").addClass("init"),
    $(document).on("click", 'a[href!="#"]', function(a) {
        switch (event.which) {
        case 1:
            newLocation = this.href,
            (newLocation.includes("ceremonycoffee") || newLocation.includes("ceremony-coffee")) && ($("body").addClass("leaving"),
            $("body").removeClass("loaded"),
            $("body").removeClass("show-minicart"),
            setTimeout(function() {
                $("body").removeClass("leaving")
            }, 1e3),
            setTimeout(function() {
                window.location = newLocation
            }, 1250),
            a.preventDefault())
        }
    }),
    $("#enter-pass .reset").click(function() {
        $("#enter-pass").addClass("hidden"),
        $("#reset-pass").removeClass("hidden")
    }),
    $(".reset-password").click(function() {
        $("#enter-pass").addClass("hidden"),
        $("#reset-pass").removeClass("hidden")
    }),
    $("#hero").length >= 1 && $("#hero article:nth-of-type(1)").hasClass("invert") && $("body").addClass("invert-nav"),
    $(".single-job form .hidden.subject") && $(".single-job form .hidden.subject input[type=text]").val($(".text-header h1").html()),
    $(".single-job form .hidden.location") && $(".single-job form .hidden.location input[type=text]").val($(".text-header .big").html()),
    $("#mobile-menu").length >= 1) {
        Scrollbar.init($("#mobile-menu")[0], {
            speed: .6,
            damping: .1,
            renderByPixels: !0,
            syncCallbacks: !0,
            continuousScrolling: !1,
            overscrollEffect: !1
        }).addListener(function(a) {
            $scrolled = a.offset.y,
            $("#mobile-menu .fixed").css("top", $scrolled + "px")
        })
    }
    if ($(document).find("#mobile-alert").length >= 1 && ($(document).find("#mobile-alert .container > div").addClass("slide"),
    $(document).find("#mobile-alert .container > div.primary").css({
        "background-color": $(document).find("#mobile-alert").attr("style")
    }),
    $(document).find("#mobile-alert").hasClass("text-white") && $(document).find("#mobile-alert .container > div.primary").addClass("text-white"),
    $(document).find("#mobile-alert .container").slick({
        arrows: !1,
        autoplay: !0,
        infinite: !1,
        fade: !1,
        slide: "div.slide",
        speed: 600,
        slidesToShow: 1
    })),
    $("#minicart #minicart-wrapper").length >= 1) {
        Scrollbar.init($("#minicart #minicart-wrapper")[0], {
            speed: .6,
            damping: .1,
            renderByPixels: !0,
            syncCallbacks: !0,
            continuousScrolling: !1,
            overscrollEffect: !1
        }).addListener(function(a) {
            $scrolled = a.offset.y,
            $("#minicart .fixed").css("top", $scrolled + "px"),
            $("#minicart footer").css("top", $scrolled + "px")
        })
    } else
        $.ajax({
            dataType: "jsonp",
            url: "https://shop.ceremonycoffee.com/cart.json",
            success: function(a) {
                var b = $("#minicart-template").html()
                  , c = Handlebars.compile(b)
                  , d = c(a);
                $("#minicart").html(d),
                Scrollbar.init($("#minicart #minicart-wrapper")[0], {
                    speed: .6,
                    damping: .1,
                    renderByPixels: !0,
                    syncCallbacks: !0,
                    continuousScrolling: !1,
                    overscrollEffect: !1
                }).addListener(function(a) {
                    $scrolled = a.offset.y,
                    $("#minicart .fixed").css("top", $scrolled + "px")
                }),
                $(document).find("header.global nav.global #cart #count").html($("#minicart #minicart-items").attr("data-count")),
                parseInt($("#minicart #minicart-items").attr("data-count")) > 0 && $(document).find("header.global nav.global #cart #status").removeClass("hide")
            }
        });
    if ($(document).on("click", ".remove-btn", function(a) {
        productId = $(this).attr("rel"),
        $.ajax({
            type: "POST",
            url: $(this).attr("data-url"),
            success: function() {
                $("#minicart .item#" + productId).addClass("hide"),
                $("#minicart .item:not(.hide)").length >= 1 ? (q = 0,
                r = 0,
                $("#minicart .item:not(.hide)").each(function() {
                    myQuantity = parseInt($(this).attr("data-quantity")),
                    q += myQuantity,
                    r++,
                    $removeURL = $(this).find(".remove-btn").attr("data-url");
                    var a = (getQueryVariable($removeURL, "line"),
                    getQueryVariable($removeURL, "quantity"),
                    {
                        line: r,
                        quantity: "0"
                    })
                      , b = "https://shop.ceremonycoffee.com/cart/change?" + jQuery.param(a);
                    $(this).find(".remove-btn").attr("data-url", b),
                    $("header.global nav.global #cart #count").html(myQuantity)
                })) : ($("body").removeClass("show-minicart"),
                $("header.global nav.global #cart #status").addClass("hide"),
                $("header.global nav.global #cart #count").html("0"))
            },
            error: function(a, b) {
                console.log(b),
                $("#minicart footer .button").click()
            }
        }),
        a.preventDefault()
    }),
    $(document).find(".global #mobile-menu .parent > a, .global #mobile-menu .menu-item-has-children > a").each(function() {
        $(this).attr("href", "#")
    }),
    $(".grid.events.upcoming").length >= 1 && $(".grid.events.upcoming").addClass("hide"),
    $(".search-results").length >= 1 && "" != $results) {
        var a = $("#results-template").html()
          , b = Handlebars.compile(a)
          , d = b($results);
        $(d).insertAfter(".search-results header"),
        $(".search-results").find("article").each(function() {
            $(this).attr("data-content") && ($data = $(this).attr("data-content").toLowerCase(),
            $data.indexOf("renew") <= 0 && $data.indexOf($query.toLowerCase()) >= 0 && $(this).removeClass("hidden"))
        }),
        $(".search-results .shop:not(.hidden)").length >= 1 && ($searchCount = parseInt($("#search-count").html()),
        0 === $searchCount ? ($(".search-results .nothing").addClass("hidden"),
        $("#search-count").html($(".search-results .shop:not(.hidden)").length)) : $("#seach-count").html($searchCount + $(".search-results .shop:not(.hidden)").length))
    }
    if ($("#pdp-top-sellers.gear").length >= 1) {
        var e = $("#gear-template").html()
          , f = Handlebars.compile(e)
          , g = f($gear);
        $("#pdp-top-sellers.gear").html(g)
    }
    var h = Scrollbar.init($("#main-scrollbar")[0], {
        speed: .6,
        damping: .1,
        renderByPixels: !0,
        syncCallbacks: !0,
        continuousScrolling: !1,
        overscrollEffect: !1
    });
    if (h.addListener(function(a) {
        $scrolled = a.offset.y,
        h.limit.x = 0,
        h.limit.y = $("#main-scrollbar .scroll-content").outerHeight() - $winH,
        h.scrollLeft = 0,
        scrollStuff($scrolled)
    }),
    $(document).on("click", ".rc_label__autodeliver", function(a) {
        $(this).parents(".rc_block").hasClass("rc_block__type--active") ? ($(this).parents(".rc_block").removeClass("rc_block__type--active"),
        $(".rc_label__onetime").click(),
        $(this).html("subscribe"),
        a.preventDefault()) : $(this).html("")
    }),
    $("#pdp-details-menu .link").click(function() {
        $id = $(this).attr("data-id"),
        $("#pdp-details-info li").removeClass("shown"),
        $("#pdp-details").addClass("expanded"),
        $("#pdp-details-info li#" + $id).addClass("shown")
    }),
    $("#pdp-details .icon-cancel, #pdp-details-info").click(function() {
        $("#pdp-details").removeClass("expanded"),
        setTimeout(function() {
            $("#pdp-details-info li").removeClass("shown")
        }, 400)
    }),
    $(".filter .options").length >= 1 && $(".filter .options").each(function() {
        Scrollbar.init($(this)[0], {
            speed: .6,
            damping: .1,
            renderByPixels: !0,
            syncCallbacks: !0,
            continuousScrolling: !1,
            overscrollEffect: !1
        })
    }),
    $(".form").length >= 1 && ($(".gform_wrapper").each(function() {
        $id = $(this).attr("id"),
        $action = $(this).find("form").attr("action"),
        $action.indexOf("?form") <= -1 && $(this).find("form").attr("action", $action + "?form=" + $id)
    }),
    window.location.href.indexOf("form=") > -1 && ($form = getQueryVariable("form"),
    h.scrollTo(0, $(".form").offset().top - 200, 1e3))),
    $(document).on("click", ".global #mobile-toggle .icon", function() {
        $("body").hasClass("show-mobile-menu") ? $("body").removeClass("show-mobile-menu") : $("body").addClass("show-mobile-menu")
    }),

    // test
   
    // end test
    $(document).on("click", ".global #mobile-menu .parent > a, .global #mobile-menu .menu-item-has-children > a", function(a) {
        $(this).parent("li").hasClass("expand") ? $(this).parent("li").removeClass("expand") : $(this).parent("li").addClass("expand"),
        a.preventDefault()
    }),
    $(document).on("mouseenter", ".global .main .parent", function() {
        clearTimeout($menuEnterIntent),
        $menu = $(this).find("a").attr("rel"),
        $menu || ($menu = $(this).attr("rel")),
        $("body").removeClass("show-minicart"),
        $(document).find("header.global").length >= 1 && ($navH = $(document).find("header.global").outerHeight(),
        $(document).find("header.global .drop .container").css("padding-top", $navH + "px")),
        $(document).find(".drop#" + $menu + " video").length >= 1 && $(document).find(".drop#" + $menu + " video").each(function() {
            $(this).hasClass("loaded") ? isIE11 ? $(this).get(0).play() : ($(this).get(0).currentTime = 0,
            $(this).get(0).paused && $(this).get(0).play()) : ($(this).find("source").attr("src", $(this).attr("data-src")),
            $(this).get(0).load(),
            $(this).addClass("loaded"),
            isIE11 ? $(this).get(0).play() : $(this).get(0).oncanplay = function() {
                $(this).parents(".card").addClass("video-loaded"),
                $(this).get(0).paused && $(this).get(0).play()
            }
            )
        }),
        $menuEnterIntent = setTimeout(function() {
            $("body").addClass("show-drop"),
            $(document).find(".drop#" + $menu).addClass("shown"),
            $(document).find(".drop:not(#" + $menu + ")").removeClass("shown")
        }, 500)
    }),
    $(document).on("click", ".global .main .parent", function() {
        clearTimeout($menuEnterIntent),
        clearTimeout($dropLeaveIntent),
        $(".drop").removeClass("shown"),
        $("body").removeClass("show-drop"),
        $(document).find(".drop#" + $menu + " video").length >= 1 && $(document).find(".drop#" + $menu + " video").each(function() {
            isIE11 || $(this).get(0).paused || $(this).get(0).pause()
        })
    }),
    $(document).on("click", ".global .search-button", function() {
        $menu = $(this).find("a").attr("rel"),
        $menu || ($menu = $(this).attr("rel")),
        $(document).find("header.global").length >= 1 && ($navH = $(document).find("header.global").outerHeight(),
        $(document).find("header.global .drop .container").css("padding-top", $navH + "px")),
        $("body").addClass("show-drop"),
        $(".drop#" + $menu).addClass("shown"),
        $(".drop:not(#" + $menu + ")").removeClass("shown")
    }),
    $(document).on("click", ".global #cart a", function(a) {
        Scrollbar.get($("#minicart #minicart-wrapper")[0]).setPosition(0, 0),
        $("body").addClass("show-minicart"),
        a.preventDefault()
    }),
    $(document).on("click", ".close-minicart", function() {
        $("body").removeClass("show-minicart")
    }),
    $(document).on("click", ".veil.full", function() {
        $("body").removeClass("show-minicart")
    }),
    $(document).on("mouseleave", ".global .main .parent", function() {
        clearTimeout($menuEnterIntent),
        clearTimeout($dropLeaveIntent),
        $dropLeaveIntent = setTimeout(function() {
            $(".drop").removeClass("shown"),
            $("body").removeClass("show-drop"),
            $(document).find(".drop#" + $menu + " video").length >= 1 && $(document).find(".drop#" + $menu + " video").each(function() {
                isIE11 || $(this).get(0).paused || $(this).get(0).pause()
            })
        }, 500)
    }),
    $(document).on("mouseleave", ".global .drop", function() {
        clearTimeout($dropLeaveIntent),
        $dropLeaveIntent = setTimeout(function() {
            $(".drop").removeClass("shown"),
            $("body").removeClass("show-drop")
        }, 500)
    }),
    $(document).on("mouseenter", ".global .drop", function() {
        clearTimeout($dropLeaveIntent)
    }),
    $(document).on("click", "#mobile-details .more-info", function() {
        $("#mobile-details").addClass("expand")
    }),
    $(document).on("click", "#mobile-details .hide-info", function() {
        $("#mobile-details").removeClass("expand")
    }),
    $(document).on("click", "form .icon-search", function() {
        $(this).parents("form").find("input[type=submit]").click()
    }),
    $(document).on("click", "#search-form .icon-cancel", function() {
        $(document).find(".drop").removeClass("shown"),
        $("body").removeClass("show-drop"),
        clearTimeout($dropLeaveIntent),
        clearTimeout($menuEnterIntent)
    }),
    $(document).on("click", "header.global #alert .icon *, header.global #alert .icon", function() {
        $(document).find(".global #alert").addClass("closed"),
        $("#wrapper").removeClass("alert-shown"),
        $(".nudge").removeClass("nudge")
    }),
    $(".stretched").anystretch(),
    $(".cards .slick").length >= 1 && $(".cards .slick").slick({
        arrows: !1,
        autoplay: !1,
        infinite: !1,
        fade: !1,
        slide: "figure",
        speed: 600,
        slidesToShow: 2,
        responsive: [{
            breakpoint: 1024,
            settings: {
                fade: !1,
                centerMode: !0,
                slidesToShow: 1,
                speed: 600
            }
        }]
    }),
    $("#hero").length >= 1 && ($("#hero article").length > 1 && ($("body").addClass("hero-start"),
    $("#hero").append('<span class="next cycle-nav"></span><span class="prev cycle-nav"></span>'),
    $(document).on("click", ".cycle-nav.next", function() {
        $("body").hasClass("hero-end") || $("#hero").slick("slickNext")
    }),
    $(document).on("click", ".cycle-nav.prev", function() {
        $("body").hasClass("hero-start") || $("#hero").slick("slickPrev")
    })),
    $("#hero.slick").slick({
        arrows: !1,
        autoplay: !0,
        infinite: !1,
        fade: !0,
        slide: "article",
        speed: 1e3,
        responsive: [{
            breakpoint: 1025,
            settings: {
                fade: !1,
                autoplay: !1,
                speed: 1e3
            }
        }]
    }),
    $(".slick").on("afterChange", function(a, b, c) {
        0 === c ? ($("body").addClass("hero-start"),
        $("body").removeClass("hero-end")) : c === $("#hero article").length - 1 ? ($("body").removeClass("hero-start"),
        $("body").addClass("hero-end")) : ($("body").removeClass("hero-start"),
        $("body").removeClass("hero-end")),
        $("#hero .slick article[data-slick-index=" + c + "]").hasClass("invert") ? $("body").addClass("invert-nav") : $("body").removeClass("invert-nav")
    })),
    $("section.taste").length >= 1 && ($(".taste aside").click(function() {
        $(".taste").addClass("started")
    }),
    $(".taste").slick({
        arrows: !1,
        autoplay: !1,
        infinite: !1,
        fade: !1,
        slide: "article",
        speed: 2e3,
        slidesToShow: 1
    }),
    $(".taste").css("background-color", $(".taste .slick-current").attr("data-bg")),
    $(".pager li:nth-of-type(1)").addClass("selected"),
    $(".taste").on("afterChange", function(a) {}),
    $(".taste").on("beforeChange", function(a, b, c, d) {
        $(".pager li.selected").removeClass("selected"),
        $(".pager li:nth-of-type(" + (d + 1) + ")").addClass("selected"),
        bg = $(".taste .slick-slide[data-slick-index=" + d + "]").attr("data-bg"),
        $(".taste").css("background-color", bg)
    }),
    $("section.taste .pager li").on("click", function() {
        $(".taste")[0].slick.slickGoTo(parseInt($(this).attr("data-count") - 1)),
        $(".pager li.selected").removeClass("selected"),
        $(this).addClass("selected")
    }),
    $("section.taste .next").click(function() {
        $nth = parseInt($(this).attr("data-id")),
        $(".taste")[0].slick.slickGoTo(parseInt($nth))
    }),
    c = 1,
    $totalColors = $(".taste aside figure").length,
    $totalColors > 1 && (c = Math.floor(Math.random() * $totalColors) + 1,
    $(".taste aside figure.current").removeClass("current"),
    $(".taste aside figure:nth-of-type(" + c + ")").addClass("current"),
    setInterval(function() {
        c = Math.floor(Math.random() * $totalColors) + 1,
        $(".taste aside figure.current").removeClass("current"),
        $(".taste aside figure:nth-of-type(" + c + ")").addClass("current")
    }, 4e3)),
    canvas = document.getElementById("colorCanvas"),
    canvas.width = $(".taste").width(),
    canvas.height = $(".taste").height(),
    createProton(),
    tick()),
    $(".tbc-banner").length >= 1 && (canvas = document.getElementById("colorCanvas"),
    canvas.width = $(".tbc-banner").width(),
    canvas.height = $(".tbc-banner").height(),
    c = 0,
    $totalColors = $(".tbc-banner figure").length,
    c = Math.floor(Math.random() * $totalColors) + 1,
    $(".tbc-banner figure.current").removeClass("current"),
    $(".tbc-banner figure:nth-of-type(" + c + ")").addClass("current"),
    $totalColors > 1 && setInterval(function() {
        c = Math.floor(Math.random() * $totalColors) + 1,
        $(".tbc-banner").css("background-color", $(".tbc-banner figure:nth-of-type(" + c + ")").attr("data-color"))
    }, 1500),
    createProton(),
    tick()),
    $(".callout").click(function(a) {
        window.location.href = $(this).find(".cta").attr("href")
    }),
    $(".grid.events.list").length > 0) {
        $(".grid.events.list figure").each(function() {
            $(this).attr("data-exp") < date.yyyymmdd() && $(this).addClass("past")
        });
        var i = $(".grid.events.list")
          , j = i.children("figure").detach().get();
        j.sort(function(a, b) {
            return new Date($(a).attr("data-date")) - new Date($(b).attr("data-date"))
        }),
        i.append(j),
        ($(".grid.events.list figure:not(.past)").length < 1 || $(".grid.events.list figure").length < 1) && ($(".grid.events.list").addClass("no-events"),
        $(".coffee-breaks.cta, .coffee-labs.cta").addClass("hide"))
    }
    $("form.event-form").length > 0 && $("form.event-form").attr("data-date") < date.yyyymmdd() && $("form.event-form").addClass("past"),
    $("#pcp-coffee .bucket .cta").click(function() {
        h.scrollIntoView($("#pcp-feature")[0])
    }),
    $(".scroll-subscribe").click(function() {
        h.scrollIntoView($("#subscription-builder")[0])
    }),
    $("#pcp-feature .cta").click(function() {
        h.scrollIntoView($("#pcp-gear")[0])
    }),
    $(".cta.coffee-breaks").click(function() {
        h.scrollIntoView($(".grid.events.list")[0]),
        $(".filter li[data-filter=tag-coffee-break]").click()
    }),
    $(".cta.coffee-labs").click(function() {
        h.scrollIntoView($(".grid.events.list")[0]),
        $(".filter li[data-filter=tag-coffee-lab]").click()
    }),
    $(".cta.guides").click(function() {
        h.scrollIntoView($(".grid.guide.list")[0])
    }),
    $(document).find(".jump select").on("change", function() {
        var a = $(this).val();
        return a && (window.location = "https://shop.ceremonycoffee.com/" + a),
        !1
    }),
    $(document).on("click", "#newsletter", function() {
        $(this).hasClass("default") && (clearTimeout($focusTimeout),
        $("#newsletter.default").addClass("form").removeClass("default"),
        $focusTimeout = setTimeout(function() {
            $form.find("input[type=email]").focus()
        }, 600))
    }),
    $form.length > 0 && $form.bind("submit", function(a) {
        register($form),
        a.preventDefault()
    }),
    $form.find("input[type=email]").bind("input propertychange", function() {
        testEmail.test($(this).val()) ? $form.find("input[type=submit]").prop("disabled", !1) : $form.find("input[type=submit]").prop("disabled", !0)
    }),
    $(document).on("click", "#newsletter-response, #newsletter-response span", function(a) {
        $("#newsletter").hasClass("error") ? $("#newsletter").attr("class", "form") : $("#newsletter").attr("class", "default"),
        a.stopPropagation()
    }),
    $(document).on("mouseenter click", ".filter", function() {
        $(this).hasClass("expand") ? $(this).removeClass("expand") : ($(".filter.expand").removeClass("expand"),
        $(this).addClass("expand"))
    }),
    $(document).on("mouseleave", ".filter", function() {
        $(this).removeClass("expand")
    }),
    $(".filters .filter:not(.sort) .options li").length > 1 && $(".filters .filter:not(.sort) .options li").each(function() {
        0 == $(this).parents("section").find(".filterable." + $(this).attr("data-filter")).length && $(this).addClass("hidden")
    }),
    $(document).on("click", ".filter:not(.sort) .options li", function() {
        $this = $(this),
        h.scrollIntoView($this.parents("section")[0]),
        $this.parents("section").find(".filters .scroll-content").css("transform", "translate3d(0,0,0)"),
        $filters = "",
        $this.parents("section").find(".filterable").removeClass("show"),
        $this.hasClass("active") ? $this.removeClass("active") : ($this.parents(".options").find("li.active").removeClass("active"),
        $this.addClass("active")),
        $this.parents("section").find(".filter .active").length < 1 ? $this.parents("section").removeClass("filtered") : $this.parents("section").addClass("filtered"),
        $this.parents(".filters").find(".filter:not(.expand) .options li:not(.active)").each(function() {
            0 == $this.parents("section").find(".filterable." + $(this).attr("data-filter") + "." + $this.attr("data-filter")).length ? $(this).addClass("hide") : $(this).removeClass("hide")
        }),
        $(".filter").removeClass("expand"),
        $this.parents("section").find(".filters .active").each(function() {
            $filters += "." + $(this).attr("data-filter")
        }),
        $this.parents("section").find(".filter").each(function() {
            $(this).find(".active").length > 0 ? $(this).find(".selected").html($(this).find(".active").html()) : $(this).find(".selected").html($(this).find(".selected").attr("data-reset"))
        }),
        "" != $filters && $this.parents("section").find(".filterable" + $filters).length > 0 ? ($this.parents("section").find(".filterable" + $filters).addClass("show"),
        $this.parents("section").find("header hgroup p").html("Results (" + $(this).parents("section").find(".filterable" + $filters).length + ")")) : ($this.parents("section").find("header hgroup p").html($(this).parents("section").find("header hgroup p").attr("data-reset")),
        $this.parents("section").find(".filters .filter .options li.hide").removeClass("hide"),
        $this.parents("section").find(".filter").each(function() {
            $(this).find(".selected").html($(this).find(".selected").attr("data-reset"))
        }),
        $this.parents(".options").find("li.active").removeClass("active"),
        $this.parents("section").removeClass("filtered"),
        $this.parents("section").find(".filterable").removeClass("show"))
    }),
    $(document).on("click", ".filter.sort .options li", function() {
        $(".filter").removeClass("expand"),
        $(this).parents("section").find("figure").addClass("visible"),
        $(this).hasClass("active") ? ($(this).removeClass("active"),
        $(this).parents("section").find(".filterable").sort(function(a, b) {
            return +a.getAttribute("data-original") - +b.getAttribute("data-original")
        }).appendTo($(this).parents("section"))) : ($(this).parents(".options").find("li.active").removeClass("active"),
        $(this).addClass("active"),
        $(this).hasClass("price-low") ? $(this).parents("section").find(".filterable").sort(function(a, b) {
            return +a.getAttribute("data-price") - +b.getAttribute("data-price")
        }).appendTo($(this).parents("section")) : $(this).parents("section").find(".filterable").sort(function(a, b) {
            return +a.getAttribute("data-price") + +b.getAttribute("data-price")
        }).appendTo($(this).parents("section")))
    }),
    $("#pdp-hero").length >= 1 && $("#pdp-object").length >= 1 ? ($("#wrapper").hasClass("alert-shown") && $("#pdp-object img").addClass("nudge"),
    TweenLite.set($("#pdp-object img"), {
        top: "50%",
        left: "55%",
        x: "-90%",
        y: "-50%",
        rotation: 0,
        scale: 1
    }),
    tl = new TimelineMax({
        paused: !0
    }),
    tl.fromTo($("#pdp-object img"), 1, {
        top: "50%",
        left: "55%",
        x: "-90%",
        y: "-50%",
        rotation: 0,
        scale: 1
    }, {
        top: "50%",
        left: "50%",
        x: "-50%",
        y: "-50%",
        rotation: 0,
        scale: .6
    })) : $("#pdp-hero").length >= 1 && $("#pdp-object-gear").length >= 1 && $("#wrapper").hasClass("alert-shown") && $("#pdp-object-gear img").addClass("nudge"),
    $("#pdp-colors").length > 0 && (c = 0,
    $totalColors = $("#pdp-colors article figure").length,
    $("#pdp-colors article figure:nth-of-type(1)").addClass("current"),
    $totalColors > 1 && setInterval(function() {
        c++,
        c > $totalColors && (c = 1),
        $("#pdp-colors article figure.current").removeClass("current"),
        $("#pdp-colors article figure:nth-of-type(" + c + ")").addClass("current")
    }, 2e3)),
    $(".subscription-card .button.subscribe").click(function(a) {
        $id = $(this).attr("data-id"),
        $(".subscribe-form.show .scroll-content").length >= 1 && Scrollbar.destroy($(".subscribe-form.show")[0]),
        $(".subscribe-form.show").removeClass("show"),
        $(".subscribe-form#" + $id).addClass("show");
        Scrollbar.init($(".subscribe-form.show")[0], {
            speed: .6,
            damping: .1,
            renderByPixels: !0,
            syncCallbacks: !0,
            continuousScrolling: !1,
            overscrollEffect: !1
        });
        $(".subscribe-form#" + $id).find(".rc_label__autodeliver").click(),
        $("#subscription-builder").offset().top > 0 && Scrollbar.get($("#main-scrollbar")[0]).scrollIntoView($("#subscription-builder .card:first-of-type")[0]),
        $("footer.global").offset().top < $(window).height() && ($stack = $("#hero").outerHeight() + $("#three-col").outerHeight() + $("#callout").outerHeight() + $("#subscription-builder").outerHeight() - $(window).height(),
        Scrollbar.get($("#main-scrollbar")[0]).scrollIntoView($("#subscription-builder")[0])),
        a.preventDefault()
    }),
    $(".subscription-card .target").click(function(a) {
        $(this).parents(".card").find(".button.subscribe").click(),
        a.preventDefault()
    }),
    $(".subscribe-form .cancel").click(function(a) {
        $(".subscribe-form").removeClass("show"),
        a.preventDefault()
    })
}
function loadScripts() {
    $winW = $(window).width(),
    $winH = $(window).height(),
    setStage($winW, $winH),
    $(".background-video").each(function() {
        $(this).find("source").attr("src", $(this).attr("data-src")),
        isIE11 || ($(this).get(0).oncanplaythrough = function() {
            $(this).parents("section").addClass("video-loaded")
        }
        )
    }),
    $(".has-video video").length >= 1 && $(".has-video").each(function() {
        $(this).find("video").hasClass("started") || ($(this).find("video").addClass("started"),
        $vidEl2 = $(this).find("video").get(0),
        isIE11 ? $vidEl2.play() : ($vidEl2.currentTime = 0,
        $vidEl2.paused && $vidEl2.play()))
    }),
    $("body img").each(function() {
        $(this).is(":visible") && $(this).hide().show(0)
    }),
    $("body").addClass("loaded")
}
function scrollStuff(a) {
    if ($navH = $(document).find("header.global").outerHeight(),
    $("#main-scrollbar .fixed").css("top", a + "px"),
    //test
    a > $navH ? ($(document).find("header.global .veil").css("max-height", $navH),
    $(document).find("header.global").addClass("sticky")) : ($(document).find("header.global .veil").css("max-height", 1.5 * a),
    $(document).find("header.global").removeClass("sticky")),
    // a > $navH ? ($(document).find("header.global .veil").css("max-height", $navH)
    // : ($(document).find("header.global .veil").css("max-height", 1.5 * a),
    //end test
    a / 5 <= $(document).find("#alert").outerHeight() && !$(document).find("#alert").hasClass("closed") && $(document).find("#alert").is(":visible") ? ($(document).find("header.global").css("transform", "translateY(" + a / 5 * -1 + "px)"),
    $(document).find(".nudge").css("margin-top", a / 5 * -1 + "px")) : !$(document).find("#alert").hasClass("closed") && $(document).find("#alert").is(":visible") && ($(document).find("header.global").css("transform", "translateY(" + -1 * $(document).find("#alert").outerHeight() + "px)"),
    $(document).find(".nudge").css("margin-top", -1 * $("#alert").outerHeight() + "px")),
    $("#hero").length >= 1 && ($(document).find("#hero img").css("top", a / 5 + "px"),
    $(document).find("#hero video").length >= 1 && $(document).find("#hero video").css("margin-top", a / 5 + "px")),
    $("#pdp-hero").length >= 1 && $("#pdp-object").is(":visible") && $("#pdp-intro h1").length >= 1) {
        if (tl) {
            var b = (tl.totalProgress(),
            a / ($winH / 1.5));
            tl.progress(b)
        }
        $("#pdp-object").length >= 1 && ($("#pdp-intro").offset().top + $("#pdp-intro article").outerHeight() - $(".object").height() / 2 < 0 ? $stopObject = !0 : $stopObject = !1),
        $("#pdp-colors").length >= 1 ? $("#pdp-colors").offset().top < $winH / 6 ? ($("#pdp-details").addClass("stop"),
        $stopOrder = !0) : ($("#pdp-details").removeClass("stop"),
        $stopOrder = !1) : $("#pdp-intro").length >= 1 ? $("#pdp-intro").offset().top + $("#pdp-intro article").outerHeight() - $(".object").height() / 2 < 0 ? ($("#pdp-details").addClass("stop"),
        $stopOrder = !0) : ($("#pdp-details").removeClass("stop"),
        $stopOrder = !1) : ($("#pdp-details").removeClass("stop"),
        $stopOrder = !0),
        $("#hero-fill").css("opacity", 1 - a / ($("#hero-fill").height() / 2)),
        $stopOrder || $(".order").css("top", a + "px"),
        $stopObject || $(".object").css("top", a + "px")
    }
    $(".subscribe-form").length > 0 && ($("#subscription-builder").offset().top < 0 ? $("#subscription-builder").offset().top > -1 * $("#subscription-builder").outerHeight() + $(window).height() && $(".subscribe-form").css("top", -1 * parseFloat($("#subscription-builder").offset().top) + "px") : $(".subscribe-form").css("top", "0px")),
    $(document).find(".global .drop.shown").removeClass("shown"),
    $("body").removeClass("show-drop"),
    $("body").removeClass("show-mobile-menu"),
    $("body").removeClass("show-minicart"),
    $("section").each(function() {
        $this = $(this)[0],
        $(this).offset().top < $winH / 1.5 && ($(this).addClass("on-screen"),
        $(this).hasClass("video-loaded") && ($(this).find(".background-video").hasClass("started") || ($(this).find(".background-video").addClass("started"),
        $vidEl = $(this).find(".background-video").get(0),
        isIE11 ? $vidEl.play() : ($vidEl.currentTime = 0,
        $vidEl.paused && $vidEl.play()))),
        $(this).find(".has-video").length >= 1 && ($(this).find(".has-video video").hasClass("started") || ($(this).find(".has-video video").addClass("started"),
        $vidEl2 = $(this).find(".has-video video").get(0),
        isIE11 ? $vidEl2.play() : ($vidEl2.currentTime = 0,
        $vidEl2.paused && $vidEl2.play()))))
    }),
    $(".parallax").each(function() {
        $offset = $(this).attr("data-offset"),
        $(this).css("transform", "translateY(" + -.08 * (a - $offset) + "px)")
    }),
    $(".card-grid").length >= 1 && $(".card-grid figure").each(function() {
        $(this).offset().top < $winH && $(this).addClass("visible")
    })
}
function setStage(a, b) {
    $(document).find("header.global").length >= 1 && ($navH = $(document).find("header.global").outerHeight(),
    $(document).find("header.global .drop .container").css("padding-top", $navH + "px")),
    $(".card-grid").length >= 1 && $(".card-grid figure").each(function() {
        $(this).offset().top < b && $(this).addClass("visible")
    }),
    $(".parallax").each(function() {
        $(this).attr("style", ""),
        $offset = $(this).offset().top,
        $(this).attr("data-offset", $scrolled + $offset),
        $(this).css("transform", "translateY(" + -.08 * ($scrolled - $offset) + "px)")
    }),
    $(".filters .filter").length > 0 && $(".filters .filter").each(function() {
        $(this).find(".selected").css("min-width", $(this).find(".selected").outerWidth())
    }),
    $("#pdp-order form").length > 0 && $("#pdp-object").is(":visible") && ($("#pdp-order form").height() > b / 2 ? ($("#pdp-order").removeClass("order"),
    $("#pdp-object").removeClass("object"),
    $("div.product").addClass("short")) : ($("#pdp-order").addClass("order"),
    $("#pdp-object").addClass("object"),
    $("div.product").removeClass("short"))),
    $("#pdp-hero").length >= 1 && $("#pdp-object").length >= 1 ? ($("#wrapper").hasClass("alert-shown") && $("#pdp-object img").addClass("nudge"),
    $("#pdp-object").addClass("show")) : $("#pdp-hero").length >= 1 && $("#pdp-object-gear").length >= 1 && $("#wrapper").hasClass("alert-shown") && $("#pdp-object-gear img").addClass("nudge"),
    $("section.taste").length >= 1 && (canvas = document.getElementById("colorCanvas"),
    canvas.width = $(".taste").width(),
    canvas.height = $(".taste").height(),
    protonCreated && renderer.resize(canvas.width, canvas.height)),
    $(".tbc-banner").length >= 1 && (canvas = document.getElementById("colorCanvas"),
    canvas.width = $(".tbc-banner").width(),
    canvas.height = $(".tbc-banner").height(),
    protonCreated && renderer.resize(canvas.width, canvas.height)),
    scrollStuff($scrolled)
}
function createProton() {
    proton = new Proton,
    createImageEmitter(),
    renderer = new Proton.Renderer("webgl",proton,canvas),
    renderer.blendFunc("ONE", "ONE"),
    renderer.start(),
    protonCreated = !0
}
function createImageEmitter() {
    emitter = new Proton.Emitter,
    emitter.rate = new Proton.Rate(new Proton.Span(0,0),new Proton.Span(.01,.015)),
    emitter.addInitialize(new Proton.Mass(1)),
    emitter.addInitialize(new Proton.Life(.1,1)),
    emitter.addInitialize(new Proton.ImageTarget([$templateDirectory + "/assets/images/particle.png"],32)),
    emitter.addInitialize(new Proton.Radius(7)),
    emitter.addInitialize(new Proton.V(new Proton.Span(0,0),500,"polar")),
    emitter.addBehaviour(new Proton.Alpha(1,0)),
    emitter.addBehaviour(new Proton.Color("#ffcc00","#ffcc00")),
    emitter.addBehaviour(new Proton.Scale(4,4)),
    emitter.p.x = $(window).width() / 2,
    emitter.p.y = $(window).height() / 2,
    emitter.emit(),
    proton.addEmitter(emitter)
}
function tick() {
    requestAnimationFrame(tick),
    proton.update()
}
function getQueryVariable(a) {
    for (var b = window.location.search.substring(1), c = b.split("&"), d = 0; d < c.length; d++) {
        var e = c[d].split("=");
        if (e[0] == a)
            return e[1]
    }
    return !1
}
function register(a) {
    $.ajax({
        type: a.attr("method"),
        url: a.attr("action"),
        data: a.serialize(),
        cache: !1,
        dataType: "jsonp",
        jsonp: "c",
        contentType: "application/json; charset=utf-8",
        success: function(b) {
            "success" != b.result ? (a.parents("#newsletter").removeClass("form"),
            a.parents("#newsletter").removeClass("success"),
            a.parents("#newsletter").removeClass("default"),
            a.parents("#newsletter").addClass("response"),
            a.parents("#newsletter").addClass("error")) : (a.parents("#newsletter").removeClass("form"),
            a.parents("#newsletter").removeClass("error"),
            a.parents("#newsletter").removeClass("default"),
            a.parents("#newsletter").addClass("response"),
            a.parents("#newsletter").addClass("success"))
        }
    })
}
$winW = $(window).width(),
$winH = $(window).height(),
$scrolled = 0;
var scrollbar;
$navH = 120,
testEmail = /^[ ]*([^@\s]+)@((?:[-a-z0-9]+\.)+[a-z]{2,})[ ]*$/i,
$form = $("#newsletter form"),
$stopOrder = !1,
$stopObject = !1;
var optionScroll, $focusTimeout, proton, renderer, emitter, stats, canvas, context, $timer;
protonCreated = !1,
$played = !1,
$tasteVideo = !1;
var tl;
$frame = 0,
$progress = 0,
$loaded = 0,
$offset = 0;
var isIE11 = !!window.MSInputMethodContext && !!document.documentMode;
isIE11 && ($("html").addClass("ie11"),
$("#main-scrollbar").hide().show(0)),
Date.prototype.yyyymmdd = function() {
    var a = this.getFullYear().toString()
      , b = (this.getMonth() + 1).toString()
      , c = this.getDate().toString();
    return a + "" + (b[1] ? b : "0" + b[0]) + (c[1] ? c : "0" + c[0])
}
;
var date = new Date, cartScroll, mobileMenuScroll, subscriptionScroll, $menuEnterIntent, $dropLeaveIntent;
Handlebars.registerHelper("eachSorted", function(a, b) {
    var c = function(a, b) {
        return new Date(b) - new Date(a)
    };
    Object.keys(a).sort(c).forEach(function(c) {
        ret += b.fn({
            key: c,
            value: a[c]
        })
    })
}),
Handlebars.registerHelper("iter", function(a, b) {
    var c = b.fn
      , d = b.inverse
      , e = "";
    if (a && a.length > 0)
        for (var f = 0, g = a.length; f < g; f++)
            e += c($.extend({}, a[f], {
                i: f,
                iPlus1: f + 1
            }));
    else
        e = d(this);
    return e
}),
Handlebars.registerHelper("ifCond", function(a, b, c, d) {
    switch (b) {
    case "==":
        return a == c ? d.fn(this) : d.inverse(this);
    case "===":
        return a === c ? d.fn(this) : d.inverse(this);
    case "!=":
        return a != c ? d.fn(this) : d.inverse(this);
    case "!==":
        return a !== c ? d.fn(this) : d.inverse(this);
    case "<":
        return a < c ? d.fn(this) : d.inverse(this);
    case "<=":
        return a <= c ? d.fn(this) : d.inverse(this);
    case ">":
        return a > c ? d.fn(this) : d.inverse(this);
    case ">=":
        return a >= c ? d.fn(this) : d.inverse(this);
    case "&&":
        return a && c ? d.fn(this) : d.inverse(this);
    case "||":
        return a || c ? d.fn(this) : d.inverse(this);
    default:
        return d.inverse(this)
    }
}),
Handlebars.registerHelper("formatCurrency", function(a) {
    return (.01 * a).toFixed(2)
}),
$(document).ready(function() {
    init()
}),
$(window).bind("pageshow", function(a) {
    a.originalEvent.persisted && loadScripts()
}),
window.onunload = function() {}
,
$(window).load(function() {
    loadScripts()
}).resize(function() {
    $winW = $(window).width(),
    $winH = $(window).height(),
    setStage($winW, $winH)
}),
$(document).on("keydown", function(a) {
    switch (a = a || window.event,
    a.keyCode) {
    case 27:
        $("body").removeClass("show-minicart"),
        $("body").removeClass("show-drop"),
        $(".subscribe-form.show").removeClass("show"),
        $(".drop.shown").removeClass("shown")
    }
}).on("mousemove", function(a) {
    a.pageX < .1 * $(window).width() ? $("body").hasClass("hero-start") ? ($("body").removeClass("mouse-left"),
    $("body").removeClass("mouse-right")) : ($("body").addClass("mouse-left"),
    $("body").removeClass("mouse-right")) : a.pageX > .9 * $(window).width() ? $("body").hasClass("hero-end") ? ($("body").removeClass("mouse-left"),
    $("body").removeClass("mouse-right")) : ($("body").removeClass("mouse-left"),
    $("body").addClass("mouse-right")) : ($("body").removeClass("mouse-left"),
    $("body").removeClass("mouse-right")),
    ($("section.taste").length >= 1 || $(".tbc-banner").length >= 1) && protonCreated && ($(".tbc-banner").length >= 1 ? (emitter.p.x = a.pageX - $(".tbc-banner").offset().left,
    emitter.p.y = a.pageY - $(".tbc-banner").offset().top) : (emitter.p.x = a.pageX - $("section.taste").offset().left,
    emitter.p.y = a.pageY - $("section.taste").offset().top),
    emitter.rate = new Proton.Rate(new Proton.Span(1,3),new Proton.Span(.01,.01)),
    clearTimeout($timer),
    $timer = setTimeout(function() {
        clearTimeout($timer),
        emitter.rate = new Proton.Rate(new Proton.Span(0,0),new Proton.Span(.01,.01))
    }, 60))
}).on("touchmove", function(a) {
    ($("section.taste").length >= 1 || $(".tbc-banner").length >= 1) && protonCreated && (touch = a.originalEvent.touches[0],
    $(".tbc-banner").length >= 1 ? (emitter.p.x = touch.clientX - $(".tbc-banner").offset().left,
    emitter.p.y = touch.clientY - $(".tbc-banner").offset().top) : (emitter.p.x = touch.clientX - $("section.taste").offset().left,
    emitter.p.y = touch.clientY - $("section.taste").offset().top),
    emitter.rate = new Proton.Rate(new Proton.Span(1,3),new Proton.Span(.01,.01)),
    clearTimeout($timer),
    $timer = setTimeout(function() {
        clearTimeout($timer),
        emitter.rate = new Proton.Rate(new Proton.Span(0,0),new Proton.Span(.01,.01))
    }, 60))
});
